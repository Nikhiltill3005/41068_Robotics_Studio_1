<?xml version="1.0"?>
<sdf version="1.7">
<model name="firefighting_drone">
    <static>false</static>
    
    <link name="base_link">
        <pose>0 0 0 0 0 0</pose>
        <collision name="collision">
            <geometry>
                <box>
                    <size>0.4 0.4 0.15</size>
                </box>
            </geometry>
        </collision>
        
        <visual name="visual">
            <geometry>
                <box>
                    <size>0.4 0.4 0.15</size>
                </box>
            </geometry>
            <material>
                <ambient>0.2 0.2 0.2 1</ambient>
                <diffuse>0.3 0.3 0.3 1</diffuse>
                <specular>0.1 0.1 0.1 1</specular>
            </material>
        </visual>
        
        <inertial>
            <mass>1.5</mass>
            <pose>0 0 0 0 0 0</pose>
            <inertia>
                <ixx>0.025</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.025</iyy>
                <iyz>0</iyz>
                <izz>0.04</izz>
            </inertia>
        </inertial>
    </link>
    
    <!-- Rotor links -->
    <link name="rotor_0">
        <pose>0.22 0.22 0.05 0 0 0</pose>
        <collision name="rotor_collision">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
        </collision>
        <visual name="rotor_visual">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
            <material>
                <ambient>0.8 0.8 0.8 1</ambient>
                <diffuse>0.9 0.9 0.9 1</diffuse>
            </material>
        </visual>
        <inertial>
            <mass>0.01</mass>
            <inertia>
                <ixx>0.0001</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.0001</iyy>
                <iyz>0</iyz>
                <izz>0.0001</izz>
            </inertia>
        </inertial>
    </link>
    
    <link name="rotor_1">
        <pose>-0.22 0.22 0.05 0 0 0</pose>
        <collision name="rotor_collision">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
        </collision>
        <visual name="rotor_visual">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
            <material>
                <ambient>0.8 0.8 0.8 1</ambient>
                <diffuse>0.9 0.9 0.9 1</diffuse>
            </material>
        </visual>
        <inertial>
            <mass>0.01</mass>
            <inertia>
                <ixx>0.0001</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.0001</iyy>
                <iyz>0</iyz>
                <izz>0.0001</izz>
            </inertia>
        </inertial>
    </link>
    
    <link name="rotor_2">
        <pose>-0.22 -0.22 0.05 0 0 0</pose>
        <collision name="rotor_collision">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
        </collision>
        <visual name="rotor_visual">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
            <material>
                <ambient>0.8 0.8 0.8 1</ambient>
                <diffuse>0.9 0.9 0.9 1</diffuse>
            </material>
        </visual>
        <inertial>
            <mass>0.01</mass>
            <inertia>
                <ixx>0.0001</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.0001</iyy>
                <iyz>0</iyz>
                <izz>0.0001</izz>
            </inertia>
        </inertial>
    </link>
    
    <link name="rotor_3">
        <pose>0.22 -0.22 0.05 0 0 0</pose>
        <collision name="rotor_collision">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
        </collision>
        <visual name="rotor_visual">
            <geometry>
                <cylinder>
                    <radius>0.08</radius>
                    <length>0.02</length>
                </cylinder>
            </geometry>
            <material>
                <ambient>0.8 0.8 0.8 1</ambient>
                <diffuse>0.9 0.9 0.9 1</diffuse>
            </material>
        </visual>
        <inertial>
            <mass>0.01</mass>
            <inertia>
                <ixx>0.0001</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.0001</iyy>
                <iyz>0</iyz>
                <izz>0.0001</izz>
            </inertia>
        </inertial>
    </link>
    
    <!-- RGB Camera Link (downward facing) -->
    <link name="rgb_camera_link">
        <pose>0.1 0 -0.05 0 1.5708 0</pose>
        <collision name="rgb_camera_collision">
            <geometry>
                <box>
                    <size>0.05 0.05 0.03</size>
                </box>
            </geometry>
        </collision>
        <visual name="rgb_camera_visual">
            <geometry>
                <box>
                    <size>0.05 0.05 0.03</size>
                </box>
            </geometry>
            <material>
                <ambient>0.2 0.2 0.8 1</ambient>
                <diffuse>0.2 0.2 0.8 1</diffuse>
                <specular>0.1 0.1 0.1 1</specular>
            </material>
        </visual>
        <inertial>
            <mass>0.05</mass>
            <inertia>
                <ixx>0.00001</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.00001</iyy>
                <iyz>0</iyz>
                <izz>0.00001</izz>
            </inertia>
        </inertial>
        
        <!-- RGB Camera Sensor -->
        <sensor name="rgb_camera" type="camera">
            <camera>
                <horizontal_fov>1.047</horizontal_fov>
                <image>
                    <width>640</width>
                    <height>480</height>
                    <format>R8G8B8</format>
                </image>
                <clip>
                    <near>0.1</near>
                    <far>100</far>
                </clip>
                <noise>
                    <type>gaussian</type>
                    <mean>0</mean>
                    <stddev>0.007</stddev>
                </noise>
            </camera>
            <always_on>1</always_on>
            <update_rate>30</update_rate>
            <visualize>true</visualize>
            <topic>model/firefighting_drone/rgb_camera/image</topic>
        </sensor>
    </link>
    
    <!-- IR/Thermal Camera Link (downward facing) -->
    <link name="thermal_camera_link">
        <pose>-0.1 0 -0.05 0 1.5708 0</pose>
        <collision name="thermal_camera_collision">
            <geometry>
                <box>
                    <size>0.05 0.05 0.03</size>
                </box>
            </geometry>
        </collision>
        <visual name="thermal_camera_visual">
            <geometry>
                <box>
                    <size>0.05 0.05 0.03</size>
                </box>
            </geometry>
            <material>
                <ambient>0.8 0.2 0.2 1</ambient>
                <diffuse>0.8 0.2 0.2 1</diffuse>
                <specular>0.1 0.1 0.1 1</specular>
            </material>
        </visual>
        <inertial>
            <mass>0.05</mass>
            <inertia>
                <ixx>0.00001</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.00001</iyy>
                <iyz>0</iyz>
                <izz>0.00001</izz>
            </inertia>
        </inertial>
        
        <!-- Thermal Camera Sensor (using regular camera with post-processing for thermal effect) -->
        <sensor name="thermal_camera" type="camera">
            <camera>
                <horizontal_fov>1.047</horizontal_fov>
                <image>
                    <width>320</width>
                    <height>240</height>
                    <format>L8</format>
                </image>
                <clip>
                    <near>0.1</near>
                    <far>100</far>
                </clip>
                <noise>
                    <type>gaussian</type>
                    <mean>0</mean>
                    <stddev>0.005</stddev>
                </noise>
            </camera>
            <always_on>1</always_on>
            <update_rate>10</update_rate>
            <visualize>true</visualize>
            <topic>model/firefighting_drone/thermal_camera/image</topic>
        </sensor>
    </link>
    
    <!-- Joints to connect rotors to base -->
    <joint name="rotor_0_joint" type="revolute">
        <parent>base_link</parent>
        <child>rotor_0</child>
        <axis>
            <xyz>0 0 1</xyz>
        </axis>
    </joint>
    
    <joint name="rotor_1_joint" type="revolute">
        <parent>base_link</parent>
        <child>rotor_1</child>
        <axis>
            <xyz>0 0 1</xyz>
        </axis>
    </joint>
    
    <joint name="rotor_2_joint" type="revolute">
        <parent>base_link</parent>
        <child>rotor_2</child>
        <axis>
            <xyz>0 0 1</xyz>
        </axis>
    </joint>
    
    <joint name="rotor_3_joint" type="revolute">
        <parent>base_link</parent>
        <child>rotor_3</child>
        <axis>
            <xyz>0 0 1</xyz>
        </axis>
    </joint>
    
    <!-- Camera joints -->
    <joint name="rgb_camera_joint" type="fixed">
        <parent>base_link</parent>
        <child>rgb_camera_link</child>
    </joint>
    
    <joint name="thermal_camera_joint" type="fixed">
        <parent>base_link</parent>
        <child>thermal_camera_link</child>
    </joint>

    <!-- Velocity control plugin (simpler approach) -->
    <plugin filename="libignition-gazebo-velocity-control-system.so" name="ignition::gazebo::systems::VelocityControl">
        <topic>model/firefighting_drone/cmd_vel</topic>
    </plugin>

    <!-- Joint position controller for rotors -->
    <plugin filename="libignition-gazebo-joint-position-controller-system.so" name="ignition::gazebo::systems::JointPositionController">
        <joint_name>rotor_0_joint</joint_name>
        <topic>model/firefighting_drone/joint/rotor_0_joint/cmd_vel</topic>
    </plugin>

    <plugin filename="libignition-gazebo-joint-position-controller-system.so" name="ignition::gazebo::systems::JointPositionController">
        <joint_name>rotor_1_joint</joint_name>
        <topic>model/firefighting_drone/joint/rotor_1_joint/cmd_vel</topic>
    </plugin>

    <plugin filename="libignition-gazebo-joint-position-controller-system.so" name="ignition::gazebo::systems::JointPositionController">
        <joint_name>rotor_2_joint</joint_name>
        <topic>model/firefighting_drone/joint/rotor_2_joint/cmd_vel</topic>
    </plugin>

    <plugin filename="libignition-gazebo-joint-position-controller-system.so" name="ignition::gazebo::systems::JointPositionController">
        <joint_name>rotor_3_joint</joint_name>
        <topic>model/firefighting_drone/joint/rotor_3_joint/cmd_vel</topic>
    </plugin>

    <!-- Odometry publisher -->
    <plugin filename="libignition-gazebo-odometry-publisher-system.so" name="ignition::gazebo::systems::OdometryPublisher">
        <odom_frame>firefighting_drone/odom</odom_frame>
        <robot_base_frame>firefighting_drone</robot_base_frame>
        <odom_topic>model/firefighting_drone/odometry</odom_topic>
        <odom_publish_frequency>50</odom_publish_frequency>
    </plugin>

    <!-- IMU sensor -->
    <plugin filename="libignition-gazebo-imu-system.so" name="ignition::gazebo::systems::Imu">
        <link_name>base_link</link_name>
        <topic>model/firefighting_drone/imu</topic>
        <initial_orientation_as_reference>false</initial_orientation_as_reference>
    </plugin>

    <!-- Pose publisher -->
    <plugin filename="libignition-gazebo-pose-publisher-system.so" name="ignition::gazebo::systems::PosePublisher">
        <publish_link_pose>true</publish_link_pose>
        <publish_collision_pose>false</publish_collision_pose>
        <publish_visual_pose>false</publish_visual_pose>
        <use_pose_vector_msg>true</use_pose_vector_msg>
        <static_publisher>true</static_publisher>
        <static_update_frequency>1</static_update_frequency>
    </plugin>

</model>
</sdf>
